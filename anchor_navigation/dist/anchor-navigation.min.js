"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_createClass=function(){function n(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}();function _classCallCheck(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}var INTERSECTION_OBSERVER="IntersectionObserver"in window,AnchorNavigation=function(){function n(e,t){_classCallCheck(this,n);var i=this;this.defaultConfig={navigation_entries:"#navigation li",navigation_current_class:"current",home_anchor:"home",onclick_callback:function(n){}},this.config=this.extend({},this.defaultConfig,{"navigation-entries":e},t);var r=this.find_nav_entries(this.config.navigation_entries),o=this.register_observer(function(n){r.set_current_page_class(n.id,i.config.navigation_current_class)});if(!o){var a=0;window.addEventListener("scroll",function(){++a>5&&(r.entries.forEach(function(n){if(n.key){var e=document.querySelector("#"+n.key);if(e){var t=e.getBoundingClientRect();t.top<window.innerHeight&&t.top>0&&r.set_current_page_class(e.id,i.config.navigation_current_class)}}}),a=0)})}r.entries.forEach(function(n){if(n.key){var e=document.querySelector("#"+n.key);e&&o&&o.observe(e),n.anchor_element.addEventListener("click",function(n){i.config.onclick_callback(n)})}})}return _createClass(n,[{key:"register_observer",value:function(n){if(!INTERSECTION_OBSERVER)return!1;return new IntersectionObserver(function(e,t){e.forEach(function(e){e.intersectionRatio>=1&&n(e.target)})},{root:null,rootMargin:"0px",threshold:1})}},{key:"find_nav_entries",value:function(n){var e=this,t=new NavEntries;return document.querySelectorAll(n).forEach(function(n){var i=n;"A"!==n.tagName&&(i=n.querySelector("a"));var r=i.href.split("#")[1];n.classList.contains(e.config.navigation_current_class)&&(r=e.config.home_anchor,i.href+="#"+e.config.home_anchor),r&&t.add(r,n,i)}),t}},{key:"extend",value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];for(var r=1;r<t.length;r++)for(var o in t[r])t[r].hasOwnProperty(o)&&(n.is_dictionary(t[r][o])?t[0][o]=this.extend(t[0][o],t[r][o]):t[0][o]=t[r][o]);return t[0]}}],[{key:"is_dictionary",value:function(n){return!("object"!==(void 0===n?"undefined":_typeof(n))||null===n||n instanceof Array||n instanceof Date)}}]),n}(),NavEntries=function(){function n(e){_classCallCheck(this,n),this.entries=[]}return _createClass(n,[{key:"push",value:function(n){n instanceof NavEntry&&this.entries.push(n)}},{key:"add",value:function(n,e,t){var i=new NavEntry(n,e,t);this.push(i)}},{key:"find",value:function(n){return this.entries.find(function(e){return e.key===n})}},{key:"set_current_page_class",value:function(n,e){this.entries.map(function(n){return n.list_element.classList.remove(e)}),this.find(n).list_element.classList.add(e)}}]),n}(),NavEntry=function n(e,t,i){_classCallCheck(this,n),this.key=e,this.list_element=t,this.anchor_element=i};"undefined"!=typeof jQuery&&(jQuery.fn.anchorNavigation=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new AnchorNavigation(this[0],n),this});